{%- assign has_compare_btn = false -%}
{%- assign has_wishlist_btn = false -%}
{%- if block.settings.show_compare_btn and settings.enable_compare -%}
  {%- assign has_compare_btn = true -%}
{%- endif -%}
{%- if block.settings.show_wishlist_btn and settings.enable_wishlist -%}
  {%- assign has_wishlist_btn = true -%}
{%- endif -%}
<div class="w100" {{ block.shopify_attributes }}>
  {%- render 'product-single-customizable-fields' -%}
  <div class="product-form__item product-form__item--quantity{% if align_center_button %} center-block text-center{% endif %} gutter-ele-top gutter-ele-bottom flex">
    {%- if block.settings.show_quantity_selector -%}
    <div class="qty-box qty-box--single flex flex-align-ver flex-align-space-between{% if full_qty_box %} qty-box--single-full{% endif %}">
      <a href="#" class="qty-box__ctrl qty-box__ctrl--descrease flex flex-align-hoz flex-align-ver" aria-label="button">
        {%- render 'icon-minus' -%}
      </a>
      <input type="number" name="quantity" value="1" min="1" class="qty-box__input w100{% if template.suffix != 'quick_view' %} qty-box__input--sync{% endif %} text-center h100 qty-box__input--single" aria-label="form" style="font-size:20px;">
      <a href="#" class="qty-box__ctrl qty-box__ctrl--increase flex flex-align-hoz flex-align-ver" aria-label="button">
        {%- render 'icon-plus' -%}
      </a>
    </div>
    {%- endif -%}
    {%- if current_variant.available -%}
      {%- unless settings.pre_order_enable and product.first_available_variant.inventory_policy == 'continue' and product.first_available_variant.inventory_quantity <= 0 -%}
        {%- assign cart_text = 'products.product.add_to_cart' | t -%}
      {%- else -%}
        {%- assign cart_text = 'products.product.pre_order' | t -%}
      {%- endunless -%}
    {%- else -%}
      {%- assign cart_text = 'products.product.sold_out' | t -%}  
    {%- endif -%}  
    <button class="button button--rad button--one-line add-cart-btn button--single-cart button--cart button--border-transparent flex flex-align-ver flex-align-hoz add-cart-btn--state por{% if template.suffix != 'quick_view' %} button--single-cart-main{% endif %}" type="submit" name="add" title="{{ cart_text | escape }}" aria-label="button" style="height:45px;flex-grow:1;"{% unless current_variant.available %} disabled="disabled"{% endunless %}>
      {%- render 'icon-cart' with add_class: 'button__icon' -%}
      <span{% if section.settings.enable_cart_animation %} class="ring-little"{% endif %}>{{ cart_text }}</span>
    </button>
    {%- if has_wishlist_btn -%}
      <a title="{{ 'collections.product_item.add_to_wishlist' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--wl button--wl-text button--wl-single button--single-inline flex flex-align-ver flex-align-hoz transition hidden-xs" data-toggle="tooltip" data-placement="top" data-product-title="{{ product.title | escape }}">
        {% render 'icon-wishlist' %}
      </a>
    {%- endif -%}
    {%- if has_compare_btn -%}
      <a title="{{ 'collections.product_item.add_to_compare' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--cp button--cp-single button--single-inline flex flex-align-ver flex-align-hoz transition hidden-xs" data-toggle="tooltip" data-placement="top" data-product-title="{{ product.title | escape }}">
        {%- render 'icon-compare' -%}
      </a>
    {%- endif -%}
  </div>
  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' -%}
    {% if block.settings.show_dynamic_checkout %}
    <div class="shopify-payment-btn-wrap w100">
      <div id="shopify_buy_now" style="display:none;">
                    {{ form | payment_button }}
                   </div>
                  <div id="block_buy_now" style="display:none;">
                      {% render 'gokwik-buy-now' %}
                      </div>
    </div>
    {% endif %}
  {%- endif -%}
  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' -%}
    <!-- Customize Button Start -->
    <div class="customize-card" style="background:#e8f5e9;border-radius:16px;border:1px solid #b2dfdb;padding:14px 18px;margin-top:14px;box-shadow:0 2px 12px rgba(39,174,96,0.08);">
      <div>
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:4px;">
  <svg width="22" height="22" fill="none" viewBox="0 0 24 24" style="flex-shrink:0;"><circle cx="12" cy="12" r="11" stroke="#27ae60" stroke-width="2" fill="#e8f5e9"/><path d="M8 12l2.5 2.5L16 9" stroke="#27ae60" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
  <span class="customize-card__title" style="font-size:1.08rem;font-weight:700;color:#27ae60;">Personalise your cricket bat</span>
</div>
<div class="customize-card__desc" style="color:#222;font-size:0.98rem;margin-bottom:2px;">Laser Name Engraving to make the bat unmistakably yours</div>
<span style="display:inline-block;background:#ffeaea;color:#d32f2f;font-weight:600;font-size:12px;padding:2px 10px;border-radius:20px;margin-bottom:8px;margin-top:2px;">Only for PREPAID orders</span>
<button id="customize-product-btn" type="button" class="customize-card__btn" style="margin-top:8px;padding:8px 22px;font-size:0.98rem;border-radius:20px;background:linear-gradient(90deg,#27ae60 60%,#81c784 100%);color:#fff;font-weight:700;box-shadow:0 2px 8px rgba(39,174,96,0.09);border:none;transition:background 0.2s;">Customize</button>
      </div>
      <div class="customize-card__icon">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40" viewBox="0 0 512 512">
<path d="M0 0 C5.06356657 3.79250802 7.64439297 9.46915755 10.4921875 14.96435547 C11.92564617 17.71163244 13.39790257 20.43609529 14.875 23.16015625 C17.87934283 28.70437153 20.86310581 34.25935201 23.84179688 39.81738281 C26.7802057 45.29833888 29.73114058 50.77255529 32.68084717 56.24743652 C34.180913 59.03190159 35.68027133 61.81674755 37.1796875 64.6015625 C37.67710449 65.52533691 38.17452148 66.44911133 38.68701172 67.40087891 C39.03779785 68.05233887 39.38858398 68.70379883 39.75 69.375 C43.8625192 69.375 45.72013544 68.70523692 49.4375 67.125 C61.86962851 62.21904794 74.39498585 59.7982968 87.75 59.375 C88.74 61.355 88.74 61.355 89.75 63.375 C86.80804516 66.31695484 83.34398139 66.12064558 79.375 66.625 C71.98786741 67.66808223 64.94839603 69.26107145 57.8125 71.4375 C56.5443042 71.82373535 56.5443042 71.82373535 55.25048828 72.21777344 C51.57633022 73.37206085 48.1699727 74.58577447 44.75 76.375 C48.41288228 88.41774882 48.41288228 88.41774882 55.75 98.375 C60.89650022 100.3652668 66.38896052 99.86946431 71.79492188 99.45654297 C74.22960027 99.35499669 76.40368941 99.74149614 78.75 100.375 C78.75 102.025 78.75 103.675 78.75 105.375 C77.10426767 105.40268522 75.45838931 105.42169585 73.8125 105.4375 C72.89597656 105.44910156 71.97945312 105.46070313 71.03515625 105.47265625 C66.90541526 105.34989344 62.84807505 104.88049194 58.75 104.375 C69.69524676 124.98377786 69.69524676 124.98377786 80.8125 145.5 C85.93801456 154.85743036 90.99153545 164.25254888 96.01464844 173.6652832 C99.2308763 179.68939899 102.46730373 185.70108082 105.74609375 191.69140625 C106.39357448 192.87848118 107.04087546 194.06565416 107.68798828 195.25292969 C108.90595514 197.48454701 110.12929365 199.71324398 111.35888672 201.93847656 C115.78103745 210.05983895 119.33464267 217.08574271 116.75 226.375 C114.66061268 231.21048078 112.20251553 235.81595289 109.6875 240.4375 C109.01623373 241.69654978 108.34630012 242.95631102 107.67773438 244.21679688 C106.05044264 247.27788833 104.40531551 250.32895201 102.75 253.375 C103.54237061 253.67390137 104.33474121 253.97280273 105.15112305 254.28076172 C108.92480988 255.86964517 110.29817539 258.15260194 112.75 261.375 C113.595625 260.88 114.44125 260.385 115.3125 259.875 C119.23083062 258.165183 121.51813363 257.8460167 125.75 258.375 C134.6534982 262.91760112 139.13418712 271.34495138 143.5 279.9375 C144.22123047 281.31711914 144.22123047 281.31711914 144.95703125 282.72460938 C148.49858042 289.58574432 151.43111694 295.47404352 150.75 303.375 C150.16312414 304.59182518 149.55774936 305.7998427 148.9375 307 C147.90326289 309.66878074 147.6226916 310.92472732 148.40893555 313.70556641 C149.63451541 316.22554142 150.98328235 318.60481799 152.4375 321 C153.38272596 322.63581963 154.32423413 324.27379406 155.26171875 325.9140625 C155.70322266 326.68339111 156.14472656 327.45271973 156.59960938 328.24536133 C158.88404481 332.47437879 159.89157702 336.1716071 159.875 340.9375 C160.32975203 347.08129275 163.58023186 351.32346429 167.03515625 356.19921875 C169.05336765 359.93681754 169.2007019 362.18495818 168.75 366.375 C166.08957731 371.22076991 163.10931831 375.58856056 157.75 377.375 C153.13000434 377.98061741 149.85208423 378.17651581 146 375.375 C143.34479452 371.83472602 140.97827076 368.1962473 138.75 364.375 C137.574375 364.643125 136.39875 364.91125 135.1875 365.1875 C133.37500678 365.58336435 131.56250578 365.97919314 129.75 366.375 C128.64785156 366.62765625 127.54570312 366.8803125 126.41015625 367.140625 C120.26592325 368.47832354 114.56470767 369.46580937 108.29248047 369.58374023 C99.92761061 369.74297238 94.82608961 371.1559924 87.6796875 375.78125 C84.75 377.375 84.75 377.375 81.515625 377.7578125 C76.21714127 378.62623618 72.24572152 381.1018672 67.625 383.75 C65.65693403 384.84758159 63.68816655 385.94390613 61.71875 387.0390625 C60.22601563 387.8748584 60.22601563 387.8748584 58.703125 388.72753906 C36.76162049 400.96805431 14.87922098 411.84076551 -10.47583008 414.11352539 C-12.27183697 414.19801977 -12.27183697 414.19801977 -13.25 415.375 C-14.91617115 415.41563832 -16.58388095 415.417721 -18.25 415.375 C-18.41290527 415.96273193 -18.57581055 416.55046387 -18.74365234 417.15600586 C-20.69443386 423.94523015 -23.16437196 430.41887676 -25.875 436.9375 C-26.28234375 437.93330078 -26.6896875 438.92910156 -27.109375 439.95507812 C-30.111344 447.236344 -30.111344 447.236344 -31.25 448.375 C-32.92024669 448.47114133 -34.59458276 448.49687722 -36.26759338 448.49525452 C-37.35439392 448.49662918 -38.44119446 448.49800385 -39.56092834 448.49942017 C-40.76357834 448.49582489 -41.96622833 448.49222961 -43.20532227 448.48852539 C-44.46367889 448.48867142 -45.72203552 448.48881744 -47.01852417 448.4889679 C-50.47911253 448.48925585 -53.93966652 448.48335949 -57.40024686 448.47639394 C-61.01308091 448.47016003 -64.62591567 448.46955657 -68.23875427 448.46836853 C-75.08463508 448.46525532 -81.9305 448.45704208 -88.7763738 448.44701904 C-96.56826589 448.43585757 -104.36015873 448.43034737 -112.15205681 448.42532361 C-128.18471386 448.41485946 -144.2173549 448.39726023 -160.25 448.375 C-160.26514341 444.88135246 -160.27419406 441.38771352 -160.28222656 437.89404297 C-160.28654694 436.91433029 -160.29086731 435.93461761 -160.2953186 434.92521667 C-160.309438 426.71863912 -159.8365243 418.66757653 -159 410.5 C-158.9001329 409.49249191 -158.9001329 409.49249191 -158.79824829 408.46463013 C-155.10315889 371.34011213 -148.14914615 329.09036399 -122.25 300.375 C-121.57582031 299.60800781 -120.90164062 298.84101563 -120.20703125 298.05078125 C-110.13498185 287.2448849 -98.29094156 281.89793829 -84.25 278.375 C-83.59 278.375 -82.93 278.375 -82.25 278.375 C-81.92 276.065 -81.59 273.755 -81.25 271.375 C-82.21679688 271.02308594 -83.18359375 270.67117188 -84.1796875 270.30859375 C-98.38637469 264.9847438 -111.20064953 257.39595074 -118.25 243.375 C-120.75300417 237.14877713 -122.45045701 231.068509 -122.20703125 224.3203125 C-122.18576172 223.37542969 -122.16449219 222.43054688 -122.14257812 221.45703125 C-122.08939455 219.49313056 -122.02437834 217.52951299 -121.94726562 215.56640625 C-121.79157835 209.36500619 -121.79157835 209.36500619 -124.19921875 203.8046875 C-126.85894934 199.35660472 -127.04497385 195.46989975 -127.25 190.375 C-128.10549438 190.0507605 -128.10549438 190.0507605 -128.97827148 189.7199707 C-131.55641915 188.72958952 -134.12157293 187.70910213 -136.6875 186.6875 C-138.03424805 186.17799805 -138.03424805 186.17799805 -139.40820312 185.65820312 C-140.68920898 185.1409668 -140.68920898 185.1409668 -141.99609375 184.61328125 C-142.78685303 184.30430908 -143.5776123 183.99533691 -144.39233398 183.67700195 C-146.25 182.375 -146.25 182.375 -147.01586914 179.73510742 C-147.09313232 178.95627197 -147.17039551 178.17743652 -147.25 177.375 C-142.76439474 174.19313773 -138.28930354 173.25115494 -133 172.1875 C-132.19175781 172.01025391 -131.38351563 171.83300781 -130.55078125 171.65039062 C-125.01829464 170.5040594 -119.89763713 170.21056077 -114.25 170.375 C-114.1571875 169.21742188 -114.064375 168.05984375 -113.96875 166.8671875 C-113.38603015 162.26815203 -111.86149696 158.5958619 -109.75 154.5 C-109.39470215 153.80527588 -109.0394043 153.11055176 -108.67333984 152.39477539 C-100.87236248 137.73772299 -88.11493318 128.7581852 -72.6015625 123.47265625 C-67.41756013 121.94481977 -62.24578228 121.03226563 -56.89453125 120.29296875 C-55.64647705 120.11918701 -54.39842285 119.94540527 -53.11254883 119.76635742 C-51.69558716 119.5726355 -51.69558716 119.5726355 -50.25 119.375 C-50.5933287 118.86738129 -50.93665741 118.35976257 -51.29039001 117.83676147 C-54.91075922 112.48328727 -58.52886784 107.1282903 -62.14575195 101.77246094 C-63.49024184 99.78217219 -64.83527991 97.79225363 -66.1809082 95.80273438 C-79.07956517 76.73056624 -79.07956517 76.73056624 -84.56640625 68.2890625 C-85.2426001 67.24959473 -85.91879395 66.21012695 -86.61547852 65.13916016 C-89.65730371 59.99509072 -90.7913871 56.28211009 -90.04296875 50.3828125 C-85.87825179 34.58561024 -73.97206143 20.8757774 -60.2734375 12.5703125 C-45.56100798 4.66984319 -16.40013314 -8.18401947 0 0 Z" fill="#E7E7E7" transform="translate(206.25,32.625)"/>
<path d="M0 0 C5.06356657 3.79250802 7.64439297 9.46915755 10.4921875 14.96435547 C11.92564617 17.71163244 13.39790257 20.43609529 14.875 23.16015625 C17.87934283 28.70437153 20.86310581 34.25935201 23.84179688 39.81738281 C26.7802057 45.29833888 29.73114058 50.77255529 32.68084717 56.24743652 C34.180913 59.03190159 35.68027133 61.81674755 37.1796875 64.6015625 C37.67710449 65.52533691 38.17452148 66.44911133 38.68701172 67.40087891 C39.03779785 68.05233887 39.38858398 68.70379883 39.75 69.375 C43.8625192 69.375 45.72013544 68.70523692 49.4375 67.125 C61.86962851 62.21904794 74.39498585 59.7982968 87.75 59.375 C88.74 61.355 88.74 61.355 89.75 63.375 C86.80804516 66.31695484 83.34398139 66.12064558 79.375 66.625 C71.98786741 67.66808223 64.94839603 69.26107145 57.8125 71.4375 C56.5443042 71.82373535 56.5443042 71.82373535 55.25048828 72.21777344 C51.57633022 73.37206085 48.1699727 74.58577447 44.75 76.375 C48.41288228 88.41774882 48.41288228 88.41774882 55.75 98.375 C60.89650022 100.3652668 66.38896052 99.86946431 71.79492188 99.45654297 C74.22960027 99.35499669 76.40368941 99.74149614 78.75 100.375 C78.75 102.025 78.75 103.675 78.75 105.375 C77.10426767 105.40268522 75.45838931 105.42169585 73.8125 105.4375 C72.89597656 105.44910156 71.97945312 105.46070313 71.03515625 105.47265625 C66.90541526 105.34989344 62.84807505 104.88049194 58.75 104.375 C69.69524676 124.98377786 69.69524676 124.98377786 80.8125 145.5 C85.93801456 154.85743036 90.99153545 164.25254888 96.01464844 173.6652832 C99.2308763 179.68939899 102.46730373 185.70108082 105.74609375 191.69140625 C106.39357448 192.87848118 107.04087546 194.06565416 107.68798828 195.25292969 C108.90595514 197.48454701 110.12929365 199.71324398 111.35888672 201.93847656 C115.78103745 210.05983895 119.33464267 217.08574271 116.75 226.375 C114.66061268 231.21048078 112.20251553 235.81595289 109.6875 240.4375 C109.01623373 241.69654978 108.34630012 242.95631102 107.67773438 244.21679688 C106.05044264 247.27788833 104.40531551 250.32895201 102.75 253.375 C103.54237061 253.67390137 104.33474121 253.97280273 105.15112305 254.28076172 C108.92480988 255.86964517 110.29817539 258.15260194 112.75 261.375 C113.595625 260.88 114.44125 260.385 115.3125 259.875 C119.23083062 258.165183 121.51813363 257.8460167 125.75 258.375 C134.6534982 262.91760112 139.13418712 271.34495138 143.5 279.9375 C144.22123047 281.31711914 144.22123047 281.31711914 144.95703125 282.72460938 C148.49858042 289.58574432 151.43111694 295.47404352 150.75 303.375 C150.16312414 304.59182518 149.55774936 305.7998427 148.9375 307 C147.90326289 309.66878074 147.6226916 310.92472732 148.40893555 313.70556641 C149.63451541 316.22554142 150.98328235 318.60481799 152.4375 321 C153.38272596 322.63581963 154.32423413 324.27379406 155.26171875 325.9140625 C155.70322266 326.68339111 156.14472656 327.45271973 156.59960938 328.24536133 C158.88404481 332.47437879 159.89157702 336.1716071 159.875 340.9375 C160.32975203 347.08129275 163.58023186 351.32346429 167.03515625 356.19921875 C169.05336765 359.93681754 169.2007019 362.18495818 168.75 366.375 C166.08957731 371.22076991 163.10931831 375.58856056 157.75 377.375 C153.13000434 377.98061741 149.85208423 378.17651581 146 375.375 C143.34479452 371.83472602 140.97827076 368.1962473 138.75 364.375 C137.574375 364.643125 136.39875 364.91125 135.1875 365.1875 C133.37500678 365.58336435 131.56250578 365.97919314 129.75 366.375 C128.64785156 366.62765625 127.54570312 366.8803125 126.41015625 367.140625 C119.49612203 368.64592167 113.17200531 369.4923972 106.125 369.625 C98.57788728 369.80246817 93.6795345 371.89952694 87.38671875 375.9765625 C84.75 377.375 84.75 377.375 82.66796875 377.41796875 C71.68489192 371.44550131 65.73448071 353.12533827 62.31640625 342.1875 C61.45053697 337.88801115 61.45053697 337.88801115 62.75 335.375 C65.25390625 333.671875 65.25390625 333.671875 68.3125 332.125 C69.32441406 331.60421875 70.33632813 331.0834375 71.37890625 330.546875 C72.16136719 330.16015625 72.94382812 329.7734375 73.75 329.375 C73.24210938 328.80394531 72.73421875 328.23289062 72.2109375 327.64453125 C63.85377855 317.80061182 58.42680515 306.03905746 55.75 293.375 C56.08 292.385 56.41 291.395 56.75 290.375 C58.45892905 289.62682253 60.17416968 288.88938035 61.91992188 288.23168945 C66.87613006 286.33937194 70.73900175 284.78449391 73.890625 280.390625 C76.17871353 275.07562642 76.17871353 275.07562642 76.59375 269.38671875 C75.21559193 266.10083262 74.23400448 264.02634011 71.75 261.375 C68.17080543 260.59466134 64.64897399 260.71887501 61 260.8125 C53.25670888 260.98330789 47.68107678 260.74102203 41.75 255.375 C39.13371993 252.55804685 36.94372062 249.52843819 34.75 246.375 C34.37852844 245.84610168 34.00705688 245.31720337 33.62432861 244.77227783 C31.08411881 241.15164365 28.58389596 237.50534706 26.10424805 233.84301758 C24.79584153 231.91292632 23.47920832 229.98862004 22.16210938 228.06445312 C21.32762673 226.8362759 20.49362391 225.60777249 19.66015625 224.37890625 C19.06969261 223.51804161 19.06969261 223.51804161 18.46730042 222.63978577 C15.75 218.6042369 15.75 218.6042369 15.75 216.375 C15.09 216.375 14.43 216.375 13.75 216.375 Z" fill="#E7E7E7"/>
</svg>
</div>
    </div>
    <style>
      .customize-card {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #e8f5e9;
        border-radius: 16px;
        border: 1px solid #b2dfdb;
        padding: 14px 18px;
        margin-top: 14px;
        box-shadow: 0 2px 12px rgba(39,174,96,0.08);
        min-width:0;
      }
      .customize-card__title {
        font-size: 1.08rem;
        font-weight: 700;
        margin-bottom: 0;
        color: #27ae60;
        letter-spacing:0.01em;
      }
      .customize-card__desc {
        color: #222;
        font-size: 0.98rem;
        margin-bottom: 2px;
        max-width: 320px;
      }
      .customize-card__btn {
        background:linear-gradient(90deg,#27ae60 60%,#81c784 100%);
        color: #fff;
        padding: 8px 22px;
        font-size: 0.98rem;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: 700;
        transition: background 0.2s;
        margin-top: 8px;
        box-shadow:0 2px 8px rgba(39,174,96,0.09);
      }
      .customize-card__btn:hover {
        background:linear-gradient(90deg,#81c784 60%,#27ae60 100%);
      }
      .customize-card__icon {
        margin-left: 24px;
        display: flex;
        align-items: center;
      }span#engraving-preview {
    display: none;
}
      @media (max-width: 600px) {
        .customize-card {
          flex-direction: column;
          align-items: flex-start;
          padding: 14px;
        }
        .customize-card__icon {
          margin-left: 0;
          margin-top: 14px;
        }
      }
    </style>
    <!-- Customize Modal Popup -->
    <div id="customize-modal" class="customize-modal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;">
      <div class="customize-modal-content" style="background:#fff;padding:32px 24px 24px 24px;border-radius:16px;max-width:98vw;width:500px;position:relative;text-align:center;box-shadow:0 8px 32px rgba(0,0,0,0.18);">
        <button id="close-customize-modal" style="position:absolute;top:8px;right:8px;background:none;border:none;font-size:28px;cursor:pointer;">&times;</button>
        <div style="margin-bottom:12px;">
          <div style="position:relative;display:inline-block;">
            <img id="customize-product-image" src="{{ product.featured_image | img_url: '400x' }}" alt="{{ product.title }}" style="width:140px;height:140px;object-fit:contain;">
            <span id="engraving-preview" style="position:absolute;left:0;right:0;bottom:20px;font-size:20px;font-weight:600;color:#222;letter-spacing:1px;text-shadow:0 1px 3px #fff;text-align:center;width:100%;pointer-events:none;">&nbsp;</span>
          </div>
        </div>
        <h2 style="margin-bottom:2px; font-size:22px; font-weight:700;">Personalise your cricket bat</h2>
<div style="color:#222;font-size:15px;margin-bottom:8px;">Laser Name Engraving to make the bat unmistakably yours</div>
<div style="color:#d32f2f;font-weight:bold;margin-bottom:12px;">Only for PREPAID orders</div>
        <div style="margin-bottom:4px; color:#888;font-size:14px;">At just ₹<span id="customization-price">{{ current_variant.price | divided_by: 100 | plus: 200 }}</span></div>
        <form id="customize-form" style="margin-top:16px;">
          <input type="text" id="engraving-name" name="properties[Engraving Name]" maxlength="12" autocomplete="off" placeholder="Your Engraving Name" style="width:100%;padding:12px 10px;font-size:16px;border-radius:6px;border:1px solid #ccc;text-align:center;margin-bottom:6px;">
          <div style="color:#888;font-size:12px;margin-bottom:10px;">Limit text to alphabets, numbers, no emojis or special characters. Max 12 characters allowed.</div>
          <button id="buy-now-custom" type="submit" style="display:none;width:100%;background:#1e90ff;color:#fff;padding:12px 0;font-size:16px;border:none;border-radius:4px;cursor:pointer;margin-bottom:8px;">Buy Now (₹<span id="add-to-cart-price">{{ current_variant.price | divided_by: 100 | plus: 200 }}</span>)</button>
          <!-- <button id="buy-now-custom" type="button" style="display:none;width:100%;background:#111;color:#fff;padding:12px 0;font-size:16px;font-weight:600;border:none;border-radius:4px;cursor:pointer;margin-bottom:8px;">Buy Now</button> -->
        </form>
<!-- Accordion for Terms & Conditions -->
<div id="custom-accordion-container" style="margin:14px 0 0 0;">
  <button id="custom-accordion-toggle" type="button" style="width:100%;background:#f5f5f5;border:1px solid #e0e0e0;border-radius:8px;padding:10px 16px;text-align:left;font-size:14px;font-weight:600;color:#222;cursor:pointer;outline:none;display:flex;align-items:center;justify-content:space-between;">
    Terms & Conditions for product personalization
    <span id="custom-accordion-arrow" style="font-size:18px;transition:transform 0.2s;">&#x25BC;</span>
  </button>
  <div id="custom-accordion-panel" style="max-height:0;overflow:hidden;transition:max-height 0.3s ease;background:#fafafa;border-radius:0 0 8px 8px;padding:0 16px;font-size:12px;color:#444;text-align:left;">
    <ul style="margin:12px 0 10px 18px;padding:0;list-style:disc;">
      <li>Estimated delivery time is 7-10 days.</li>
      <li>All orders will be accepted as prepaid payment only. Cash on Delivery will not be applicable for product personalization.</li>
      <li>No cancellations or edits will be allowed after placing the order.</li>
      <li>No refunds will be processed for orders under any circumstances. In case of delivery failures, only reshipment will be attempted.</li>
      <li>Reshipment may take up to 5-7 days if any product returned to origin.</li>
      <li>Product exchanges with engraving will not be provided without engraving removal fees.</li>
      <li>Image shown above is representational. Product color, font placement, font color might vary in reality.</li>
    </ul>
  </div>
</div>
<script>
(function(){
  var toggle = document.getElementById('custom-accordion-toggle');
  var panel = document.getElementById('custom-accordion-panel');
  var arrow = document.getElementById('custom-accordion-arrow');
  if(toggle && panel && arrow) {
    toggle.addEventListener('click', function() {
      if(panel.style.maxHeight && panel.style.maxHeight !== '0px') {
        panel.style.maxHeight = '0px';
        arrow.style.transform = '';
      } else {
        panel.style.maxHeight = panel.scrollHeight + 'px';
        arrow.style.transform = 'rotate(180deg)';
      }
    });
  }
})();
</script>
        <a href="#" id="skip-customization" style="display:block;color:#1e90ff;font-size:14px;text-decoration:underline;margin-top:8px;">Skip Personalization</a>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var customizeBtn = document.getElementById('customize-product-btn');
        var modal = document.getElementById('customize-modal');
        var closeBtn = document.getElementById('close-customize-modal');
        var engravingInput = document.getElementById('engraving-name');
        var engravingPreview = document.getElementById('engraving-preview');
        var addToCartBtn = document.getElementById('buy-now-custom');
        var skipBtn = document.getElementById('skip-customization');
        var customizeForm = document.getElementById('customize-form');
        var addToCartPrice = document.getElementById('add-to-cart-price');
        var customizationPrice = document.getElementById('customization-price');
        var basePrice = parseInt({{ current_variant.price | divided_by: 100 }});
        var customCharge = 200;
        // Open modal
        if (customizeBtn && modal && closeBtn) {
          customizeBtn.addEventListener('click', function() {
            modal.style.display = 'flex';
          });
          closeBtn.addEventListener('click', function() {
            modal.style.display = 'none';
            resetPopup();
          });
          modal.addEventListener('click', function(event) {
            if (event.target === modal) {
              modal.style.display = 'none';
              resetPopup();
            }
          });
        }
        // Skip personalization
        if (skipBtn) {
          skipBtn.addEventListener('click', function(e) {
            e.preventDefault();
            modal.style.display = 'none';
            resetPopup();
          });
        }
        // Input validation
        function isValidName(name) {
          return /^[A-Za-z0-9 ]{1,12}$/.test(name);
        }
        function updatePreview() {
          var val = engravingInput.value;
          if (isValidName(val)) {
            engravingPreview.textContent = val;
            addToCartBtn.style.display = 'block';
          } else {
            engravingPreview.textContent = '';
            addToCartBtn.style.display = 'none';
          }
        }
        if (engravingInput && engravingPreview && addToCartBtn) {
          engravingInput.addEventListener('input', updatePreview);
        }
        // Show Buy Now button when Add to Cart is visible
        var buyNowBtn = document.getElementById('buy-now-custom');
        if (buyNowBtn) {
          buyNowBtn.addEventListener('click', function() {
            var name = engravingInput.value;
            if (!isValidName(name)) {
              engravingInput.focus();
              return;
            }
            // Add personalized product with engraving, then customizer product, then go to checkout
            fetch('/cart/add.js', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                id: {{ current_variant.id }},
                quantity: 1,
                properties: { 'Engraving Name': name, 'Personalization Charge': '+₹200' }
              })
            })
            .then(function(res) { return res.json(); })
              .then(function() {
              // 2. Add addon product
              return fetch('/cart/add.js', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                  id: 48603629060404, // Addon variant ID
                  quantity: 1
                })
              });
            })
              
            .then(function() {
              window.location.href = '/checkout';
            });
          });
        }
        // Update price
        if (addToCartPrice && customizationPrice) {
          addToCartPrice.textContent = basePrice + customCharge;
          customizationPrice.textContent = basePrice + customCharge;
        }
//         // Add to cart with custom property
//         if (addToCartBtn) {
//           addToCartBtn.addEventListener('submit', function(e) {
//             e.preventDefault();
//             var name = engravingInput.value;
//             if (!isValidName(name)) {
//               engravingInput.focus();
//               return;
//             }
//             // Add to cart via AJAX
//             fetch('/cart/add.js', {
//               method: 'POST',
//               headers: { 'Content-Type': 'application/json' },
//               body: JSON.stringify({
//                 id: {{ current_variant.id }},
//                 quantity: 1,
//                 properties: { 'Engraving Name': name, 'Personalization Charge': '+₹50' }
//               })
//             })
//             .then(function(res) { return res.json(); })
// .then(function() {
//               // 2. Add addon product
//               return fetch('/cart/add.js', {
//                 method: 'POST',
//                 headers: { 'Content-Type': 'application/json' },
//                 body: JSON.stringify({
//                   id: 48603629060404, // Addon variant ID
//                   quantity: 1
//                 })
//               });
//             })
              
//             .then(function(data) {
//               // Redirect to Shopify native checkout after add to cart
//                buyNowWithCustomizer({{ current_variant.id }}, 'product-customizer-item-customizations');
//             })
//             .catch(function(err) {
//               alert('Could not add to cart. Please try again.');
//             });
//           });
//         }
        function resetPopup() {
          if (engravingInput) engravingInput.value = '';
          if (engravingPreview) engravingPreview.textContent = '';
          if (addToCartBtn) addToCartBtn.style.display = 'none';
        }
      });
    </script>
    {% render 'checkout-customize-popup' %}
    <script>
    // Handle custom checkout popup actions
    document.addEventListener('DOMContentLoaded', function() {
      var interval = null;
      function getCart(callback) {
        fetch('/cart.js').then(r=>r.json()).then(callback);
      }
      function updateCart(items, callback) {
        fetch('/cart/update.js', {
          method:'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ updates: items })
        }).then(r=>r.json()).then(callback);
      }
      function removeAllExcept(variantId, callback) {
        getCart(function(cart) {
          var updates = {};
          cart.items.forEach(function(item) {
            updates[item.variant_id] = (item.variant_id == variantId) ? item.quantity : 0;
          });
          updateCart(updates, callback);
        });
      }
      function removeVariant(variantId, callback) {
        getCart(function(cart) {
          var updates = {};
          cart.items.forEach(function(item) {
            updates[item.variant_id] = (item.variant_id == variantId) ? 0 : item.quantity;
          });
          updateCart(updates, callback);
        });
      }
      var popup = document.getElementById('checkout-customize-popup');
      if(popup) {
        document.getElementById('checkout-with-customize').onclick = function() {
          var vid = window.__JUST_ADDED_VARIANT_ID;
          if (!vid) return;
          removeAllExcept(vid, function() {
            window.location.href = '/checkout';
          });
        };
        document.getElementById('checkout-with-other').onclick = function() {
          var vid = window.__JUST_ADDED_VARIANT_ID;
          if (!vid) return;
          removeVariant(vid, function() {
            // Just close the popup, cart remains with other items
          });
        };
      }
    });
    </script>
    <!-- Customize Button End -->
    {%- assign cart_terms_for_id = 'single-page-' | append: section.id -%}
    {%- render 'cart-terms' with for_id: cart_terms_for_id -%}
    <div class="gutter-ele-bottom gutter-ele-bottom-tbs"></div>
  {%- endif -%}

  {%- if has_compare_btn or has_wishlist_btn -%}
  <div class="gutter-ele-top gutter-ele-bottom hidden-sm hidden-md hidden-lg">
    {%- if has_compare_btn -%}
    <a title="{{ 'collections.product_item.add_to_compare' | t | escape }}" data-id="{{ product.handle }}" href="#" class="button--cp button--cp-single dib{% if full_qty_box %} w100{% endif %}" data-product-title="{{ product.title | escape }}">
      {%- unless enable_rtl -%}
        {% render 'icon-compare' %}&nbsp;{{ 'collections.product_item.add_to_compare' | t }}
      {%- else -%}
        {{ 'collections.product_item.add_to_compare' | t }}&nbsp;{%- render 'icon-compare' -%} 
      {%- endunless -%}
    </a>
    {%- endif -%}
    {%- if has_wishlist_btn -%}
    <a title="{{ 'collections.product_item.add_to_wishlist' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--wl button--wl-text button--wl-single dib {% if full_qty_box %}w100 distance-top-ele{% else %}{% if block.settings.show_compare_btn and settings.enable_compare %}button--wl-single-distance {% endif %}gutter-ele-top-tbs{% endif %}" data-product-title="{{ product.title | escape }}">
      {%- unless enable_rtl -%}
        {% render 'icon-wishlist' %}&nbsp;<span class="wishlist-text">{{ 'collections.product_item.add_to_wishlist' | t }}</span>
      {%- else -%}
        <span class="wishlist-text">{{ 'collections.product_item.add_to_wishlist' | t }}</span>&nbsp;{%- render 'icon-wishlist' -%}
      {%- endunless -%}
    </a>
    {%- endif -%}
  </div>
  {%- endif -%}

  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' and block.settings.enable_shop_pay_banner -%}
  <div class="gutter-ele-top gutter-ele-bottom">
    {{ form | payment_terms }}
  </div>
  {%- endif -%}
  <input type="hidden" name="id" class="variant-id" value="{{ product.selected_or_first_available_variant.id }}" />