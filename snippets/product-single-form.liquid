{%- assign has_compare_btn = false -%}
{%- assign has_wishlist_btn = false -%}
{%- if block.settings.show_compare_btn and settings.enable_compare -%}
  {%- assign has_compare_btn = true -%}
{%- endif -%}
{%- if block.settings.show_wishlist_btn and settings.enable_wishlist -%}
  {%- assign has_wishlist_btn = true -%}
{%- endif -%}
<div class="w100" {{ block.shopify_attributes }}>
  {%- render 'product-single-customizable-fields' -%}
  <div class="product-form__item product-form__item--quantity{% if align_center_button %} center-block text-center{% endif %} gutter-ele-top gutter-ele-bottom flex">
    {%- if block.settings.show_quantity_selector -%}
    <div class="qty-box qty-box--single flex flex-align-ver flex-align-space-between{% if full_qty_box %} qty-box--single-full{% endif %}">
      <a href="#" class="qty-box__ctrl qty-box__ctrl--descrease flex flex-align-hoz flex-align-ver" aria-label="button">
        {%- render 'icon-minus' -%}
      </a>
      <input type="number" name="quantity" value="1" min="1" class="qty-box__input w100{% if template.suffix != 'quick_view' %} qty-box__input--sync{% endif %} text-center h100 qty-box__input--single" aria-label="form" style="font-size:20px;">
      <a href="#" class="qty-box__ctrl qty-box__ctrl--increase flex flex-align-hoz flex-align-ver" aria-label="button">
        {%- render 'icon-plus' -%}
      </a>
    </div>
    {%- endif -%}
    {%- if current_variant.available -%}
      {%- unless settings.pre_order_enable and product.first_available_variant.inventory_policy == 'continue' and product.first_available_variant.inventory_quantity <= 0 -%}
        {%- assign cart_text = 'products.product.add_to_cart' | t -%}
      {%- else -%}
        {%- assign cart_text = 'products.product.pre_order' | t -%}
      {%- endunless -%}
    {%- else -%}
      {%- assign cart_text = 'products.product.sold_out' | t -%}  
    {%- endif -%}  
    <button class="button button--rad button--one-line add-cart-btn button--single-cart button--cart button--border-transparent flex flex-align-ver flex-align-hoz add-cart-btn--state por{% if template.suffix != 'quick_view' %} button--single-cart-main{% endif %}" type="submit" name="add" title="{{ cart_text | escape }}" aria-label="button" style="height:45px;flex-grow:1;"{% unless current_variant.available %} disabled="disabled"{% endunless %}>
      {%- render 'icon-cart' with add_class: 'button__icon' -%}
      <span{% if section.settings.enable_cart_animation %} class="ring-little"{% endif %}>{{ cart_text }}</span>
    </button>
    {%- if has_wishlist_btn -%}
      <a title="{{ 'collections.product_item.add_to_wishlist' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--wl button--wl-text button--wl-single button--single-inline flex flex-align-ver flex-align-hoz transition hidden-xs" data-toggle="tooltip" data-placement="top" data-product-title="{{ product.title | escape }}">
        {% render 'icon-wishlist' %}
      </a>
    {%- endif -%}
    {%- if has_compare_btn -%}
      <a title="{{ 'collections.product_item.add_to_compare' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--cp button--cp-single button--single-inline flex flex-align-ver flex-align-hoz transition hidden-xs" data-toggle="tooltip" data-placement="top" data-product-title="{{ product.title | escape }}">
        {%- render 'icon-compare' -%}
      </a>
    {%- endif -%}
  </div>
  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' -%}
    {% if block.settings.show_dynamic_checkout %}
    <div class="shopify-payment-btn-wrap w100">
      <div id="shopify_buy_now" style="display:none;">
                    {{ form | payment_button }}
                   </div>
                  <div id="block_buy_now" style="display:none;">
                      {% render 'gokwik-buy-now' %}
                      </div>
    </div>
    {% endif %}
  {%- endif -%}
  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' -%}
    <!-- Customize Button Start -->
    <div class="customize-btn-wrap w100" style="margin-top: 16px; text-align: center;">
      <button id="customize-product-btn" type="button" class="button button--rad button--customize" style="background:#1e90ff;color:#fff;padding:12px 32px;font-size:16px;border:none;border-radius:4px;cursor:pointer;">
        <span>Customize</span>
      </button>
    </div>
    <!-- Customize Modal Popup -->
    <div id="customize-modal" class="customize-modal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;">
      <div class="customize-modal-content" style="background:#fff;padding:32px 24px;border-radius:8px;max-width:90vw;width:400px;position:relative;text-align:center;">
        <button id="close-customize-modal" style="position:absolute;top:8px;right:8px;background:none;border:none;font-size:24px;cursor:pointer;">&times;</button>
        <h2 style="margin-bottom:16px;">Product Customization</h2>
        <p style="margin-bottom:24px;">Yahan aap ka custom popup content aayega.<br>(You can customize this popup as needed.)</p>
        <!-- Add more customization content here -->
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var customizeBtn = document.getElementById('customize-product-btn');
        var modal = document.getElementById('customize-modal');
        var closeBtn = document.getElementById('close-customize-modal');
        if (customizeBtn && modal && closeBtn) {
          customizeBtn.addEventListener('click', function() {
            modal.style.display = 'flex';
          });
          closeBtn.addEventListener('click', function() {
            modal.style.display = 'none';
          });
          modal.addEventListener('click', function(event) {
            if (event.target === modal) {
              modal.style.display = 'none';
            }
          });
        }
      });
    </script>
    <!-- Customize Button End -->
    {%- assign cart_terms_for_id = 'single-page-' | append: section.id -%}
    {%- render 'cart-terms' with for_id: cart_terms_for_id -%}
    <div class="gutter-ele-bottom gutter-ele-bottom-tbs"></div>
  {%- endif -%}
  
  {%- if has_compare_btn or has_wishlist_btn -%}
  <div class="gutter-ele-top gutter-ele-bottom hidden-sm hidden-md hidden-lg">
    {%- if has_compare_btn -%}
    <a title="{{ 'collections.product_item.add_to_compare' | t | escape }}" data-id="{{ product.handle }}" href="#" class="button--cp button--cp-single dib{% if full_qty_box %} w100{% endif %}" data-product-title="{{ product.title | escape }}">
      {%- unless enable_rtl -%}
        {% render 'icon-compare' %}&nbsp;{{ 'collections.product_item.add_to_compare' | t }}
      {%- else -%}
        {{ 'collections.product_item.add_to_compare' | t }}&nbsp;{%- render 'icon-compare' -%} 
      {%- endunless -%}
    </a>
    {%- endif -%}
    {%- if has_wishlist_btn -%}
    <a title="{{ 'collections.product_item.add_to_wishlist' | t | escape }}" data-id="{{ product.id }}" href="#" class="button--wl button--wl-text button--wl-single dib {% if full_qty_box %}w100 distance-top-ele{% else %}{% if block.settings.show_compare_btn and settings.enable_compare %}button--wl-single-distance {% endif %}gutter-ele-top-tbs{% endif %}" data-product-title="{{ product.title | escape }}">
      {%- unless enable_rtl -%}
        {% render 'icon-wishlist' %}&nbsp;<span class="wishlist-text">{{ 'collections.product_item.add_to_wishlist' | t }}</span>
      {%- else -%}
        <span class="wishlist-text">{{ 'collections.product_item.add_to_wishlist' | t }}</span>&nbsp;{%- render 'icon-wishlist' -%}
      {%- endunless -%}
    </a>
    {%- endif -%}
  </div>
  {%- endif -%}

  {%- if template.suffix != 'quick_view' and template.suffix != 'select_option' and block.settings.enable_shop_pay_banner -%}
  <div class="gutter-ele-top gutter-ele-bottom">
    {{ form | payment_terms }}
  </div>
  {%- endif -%}
  <input type="hidden" name="id" class="variant-id" value="{{ product.selected_or_first_available_variant.id }}" />
</div>